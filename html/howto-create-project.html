

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating a simulation project &mdash; trc-simulator 1.1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="trc-simulator 1.1.1 documentation" href="index.html"/>
        <link rel="next" title="Choreonoid ROS Plugin Tutorial" href="tutorial.html"/>
        <link rel="prev" title="Basic usage of Choreonoid" href="howto-use-choreonoid.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> trc-simulator
          

          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="howto-use-choreonoid.html">Basic usage of Choreonoid</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creating a simulation project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#launch-choreonoid">Launch Choreonoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#open-a-model-file">Open a model file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-a-model-of-the-floor">Add a model of the floor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-a-simulator-item">Add a simulator item</a></li>
<li class="toctree-l2"><a class="reference internal" href="#specify-initial-state-of-simulation">Specify initial state of simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-simulation-settings-time-step-simulation-time-integration-mode-friction">Basic simulation settings (time step, simulation time, integration mode, friction)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#time-step">Time step</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simulation-time">Simulation time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration-mode">Integration mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#friction">Friction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#enable-cameras-and-range-sensors">Enable cameras and range sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-simulation">Run simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#save-a-project">Save a project</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Choreonoid ROS Plugin Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html">Links</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">trc-simulator</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Creating a simulation project</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/howto-create-project.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="creating-a-simulation-project">
<h1>Creating a simulation project<a class="headerlink" href="#creating-a-simulation-project" title="Permalink to this headline">¶</a></h1>
<p>This chapter explains how to create and run a simple simulation.</p>
<div class="section" id="launch-choreonoid">
<h2>Launch Choreonoid<a class="headerlink" href="#launch-choreonoid" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s launch Choreonoid first. Type the following command in gnome-terminal.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ choreonoid
</pre></div>
</div>
<p>You will see a window as follows.</p>
<img alt="_images/choreonoid.png" src="_images/choreonoid.png" />
</div>
<div class="section" id="open-a-model-file">
<h2>Open a model file<a class="headerlink" href="#open-a-model-file" title="Permalink to this headline">¶</a></h2>
<p>Create a world item named &#8220;World&#8221; first by selecting &#8220;File&#8221;, &#8220;New...&#8221; and &#8220;World&#8221; menus.</p>
<p>Then load a model file of JVRC-1 by choosing &#8220;OpenHRP Model File&#8221; followed by &#8220;File&#8221;, &#8220;Open...&#8221; menus. The filename is ~/catkin_ws/install/share/jvrc_models/model/JVRC-1/main.wrl.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure the model file is located under lower level of the &#8220;World&#8221; item.
Parent and child relationships of items have measure importance to define simulation setting in Choreonoid.
If the item is not in the desired location, you can drag and drop the item to adjust the location.</p>
</div>
<p>When you check the checkbox named &#8220;JVRC&#8221;, JVRC-1 will be displayed in the scene view as follows.</p>
<img alt="_images/model.png" src="_images/model.png" />
</div>
<div class="section" id="add-a-model-of-the-floor">
<h2>Add a model of the floor<a class="headerlink" href="#add-a-model-of-the-floor" title="Permalink to this headline">¶</a></h2>
<p>To prevent the robot from falling, let&#8217;s add a model of the ground.</p>
<p>The window of Choreonoid has a tab named &#8220;Items&#8221;. This tab is called &#8220;item view&#8221;. Select &#8220;World&#8221; item first in the item view. Then choose &#8220;OpenHRP Model File&#8221; following &#8220;File&#8221;,&#8221;Open...&#8221; menus and select the model file for the floor. Its filename is ~/catkin_ws/devel/share/choreonoid-1.5/model/misc/floor.wrl.</p>
</div>
<div class="section" id="add-a-simulator-item">
<h2>Add a simulator item<a class="headerlink" href="#add-a-simulator-item" title="Permalink to this headline">¶</a></h2>
<p>Choose &#8220;World&#8221; item in the item view. Then create a &#8220;AISTSimulator&#8221; item by following &#8220;File&#8221;, &#8220;New...&#8221; menus.</p>
<img alt="_images/aist_simulator.png" src="_images/aist_simulator.png" />
</div>
<div class="section" id="specify-initial-state-of-simulation">
<h2>Specify initial state of simulation<a class="headerlink" href="#specify-initial-state-of-simulation" title="Permalink to this headline">¶</a></h2>
<p>By set the initial position and attitude of the robot to the project file, we can start the simulation in specified state even after we restart the Choreonoid.
Setting of initial state can be applied as follows:</p>
<ol class="arabic">
<li><p class="first">Position and attitude of the root link of the robot can be edited in Body/Link view.</p>
<img alt="_images/body_link_view.png" src="_images/body_link_view.png" />
</li>
<li><p class="first">Joint angles can be edited in Joint slider view.</p>
<img alt="_images/joint_slider_view.png" src="_images/joint_slider_view.png" />
</li>
<li><p class="first">You can also edit the position and attitude visually using scene view.
To do visual editing, please switch the scene view to edit mode.</p>
</li>
<li><p class="first">Finally, press the &#8220;Store body setting to the initial world state&#8221; button on the simulation bar,</p>
<img alt="_images/simubar_save_world.png" src="_images/simubar_save_world.png" />
<p>And don&#8217;t forget to press the &#8220;Save the project&#8221; button on the file bar.</p>
<img alt="_images/filebar_save_project.png" src="_images/filebar_save_project.png" />
</li>
</ol>
</div>
<div class="section" id="basic-simulation-settings-time-step-simulation-time-integration-mode-friction">
<h2>Basic simulation settings (time step, simulation time, integration mode, friction)<a class="headerlink" href="#basic-simulation-settings-time-step-simulation-time-integration-mode-friction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="time-step">
<h3>Time step<a class="headerlink" href="#time-step" title="Permalink to this headline">¶</a></h3>
<p>For time step, 1[ms] is recommended.
Time step is trade off to computational cost and preciseness of the simulation.
We also have to define this value under consideration with execution period of controller.</p>
<ol class="arabic">
<li><p class="first">Press the setting button on the time bar.</p>
<img alt="_images/timebar_config.png" src="_images/timebar_config.png" />
</li>
<li><p class="first">Set internal frame rate to &#8220;1000&#8221;(=1ms) in the setting dialog.</p>
<img alt="_images/timebar_config_framerate.png" src="_images/timebar_config_framerate.png" />
</li>
</ol>
</div>
<div class="section" id="simulation-time">
<h3>Simulation time<a class="headerlink" href="#simulation-time" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Unlimited</p>
<ol class="arabic">
<li><p class="first">Select &#8220;AISTSimulator&#8221; item in the item view.</p>
</li>
<li><p class="first">Double click on the &#8220;time range&#8221; property on the property view to change the setting.</p>
<img alt="_images/property_timerange.png" src="_images/property_timerange.png" />
</li>
</ol>
</li>
<li><p class="first">Within time bar range</p>
<ol class="arabic">
<li><p class="first">Select &#8220;AISTSimulator&#8221; item in the item view.</p>
</li>
<li><p class="first">Double click on the &#8220;time range&#8221; property on the property view to change the setting.</p>
<img alt="_images/property_timebarlimit.png" src="_images/property_timebarlimit.png" />
</li>
<li><p class="first">Configure the start time and end time on the time bar.</p>
<img alt="_images/timebar_timelimit.png" src="_images/timebar_timelimit.png" />
</li>
</ol>
</li>
</ul>
</div>
<div class="section" id="integration-mode">
<h3>Integration mode<a class="headerlink" href="#integration-mode" title="Permalink to this headline">¶</a></h3>
<p>You can select either Runge Kutta method or Euler method to solve the differential equation in physics simulation.
Use of Runge Kutta method is recommended, because it can calculate higher order equation more precisely, while Euler method can only handle first order equation theoretically.</p>
<p>To set the integration mode, click on the AISTSimulator item and change the parameter in the property view.</p>
<img alt="_images/property_integrationmode.png" src="_images/property_integrationmode.png" />
</div>
<div class="section" id="friction">
<h3>Friction<a class="headerlink" href="#friction" title="Permalink to this headline">¶</a></h3>
<p>For frictions between the contacted objects, we can set &#8220;static friction&#8221; and &#8220;slip friction&#8221; parameters.
Static friction is applied when objects are not moving in between.
Slip friction is applied when objects are moving in between.</p>
<p>All the objects in the world are applied with the same friction parameters.</p>
<p>To set the friction parameters, click on the AISTSimulator item and change the parameters in the property view.</p>
<img alt="_images/property_friction.png" src="_images/property_friction.png" />
</div>
</div>
<div class="section" id="enable-cameras-and-range-sensors">
<h2>Enable cameras and range sensors<a class="headerlink" href="#enable-cameras-and-range-sensors" title="Permalink to this headline">¶</a></h2>
<p>To enable cameras and range sensors in simulation, do the following settings.</p>
<p>Select AISTSimulator in the item view and create a GLVisionSensorSimulator item and name it GLVisionSimulator.</p>
<img alt="_images/vision.png" src="_images/vision.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If &#8220;Target bodies&#8221; and &#8220;Target sensors&#8221; properties are empty, all the sensors exist in the simulation world will be simulated. You can improve the simulation speed by only simulating specified sensors by specifying the target sensors on the property. Within this example, ranger sensor of JVRC robot is specified as target, cameras on the robot body is ignored.</p>
<img alt="_images/vision_property.png" class="last" src="_images/vision_property.png" />
</div>
</div>
<div class="section" id="run-simulation">
<h2>Run simulation<a class="headerlink" href="#run-simulation" title="Permalink to this headline">¶</a></h2>
<p>Next press &#8220;Start simulation from the beginning&#8221; button in the simulation tool bar. Simulation will start.</p>
<img alt="_images/simulation_start.png" src="_images/simulation_start.png" />
<p>Just after starting simulation, the robot falls down.</p>
<img alt="_images/simulation_no_controller.png" src="_images/simulation_no_controller.png" />
<p>Because all joints are not controlled but free.</p>
</div>
<div class="section" id="save-a-project">
<h2>Save a project<a class="headerlink" href="#save-a-project" title="Permalink to this headline">¶</a></h2>
<p>After running simulation, let&#8217;s save the project. Choose &#8220;Save Project As&#8221; menu in &#8220;File&#8221; menu and name the project file.</p>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Choreonoid ROS Plugin Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="howto-use-choreonoid.html" class="btn btn-neutral" title="Basic usage of Choreonoid" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Advanced Industrial Science and Technology (AIST).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>